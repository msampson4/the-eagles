<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>List </title>
    <link rel="stylesheet" href="../the-eagles/Notes/Notes.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <div class="topNav">
        <a href="../the-eagles/Testing.html">Testing</a>
        <a href="../the-eagles/Notes/Notes.html">Notes</a>
        <a href="../the-eagles/App/name.html">App</a>
        <a href="../the-eagles/index/index.html">Home</a>
    </div>
</head>
<body>
<div class="header">

    <img src="/images/pngegg.png" alt="Treasure Hunt" style="width:70px; height:70px;">
    <p>Treasure Hunt</p>

</div>
<p class="text">
    First you have to choose which hunt you want to play.
</p>
<div class="explorer">
    <img src="/images/explorer.png" alt="explorer" height="125px" width="125px">

</div>
<style>
    body {
        background-image: url("../the-eagles/images/10220-15_530-b.jpg");
        background-size: cover;
        background-repeat: no-repeat;
    }
</style>


<ul id="treasureHunts"></ul>

<script>

    const treasureHuntsList = document.getElementById("treasureHunts");

    const params = new URLSearchParams(location.search);
    let name = params.get("name");
    console.log(name);

    const URL = "https://codecyprus.org/th/api/list";
  fetch(URL)
          .then(response => response.json())
          .then(jsonObject => {
            if (jsonObject.status === "OK") {
                const treasureHunts = jsonObject.treasureHunts;
                for (let i = 0; i < treasureHunts.length; i++) {
                    let newItem = document.createElement("li");
                    newItem.innerHTML = "<a href='start.html?playerName=" + name + "&treasureHuntID=" + treasureHunts[i].uuid + "'>" + treasureHunts[i].name + " </a>";
                    treasureHuntsList.appendChild(newItem);
                    // console.log(treasureHunts[i].name);
                }
            }
          });


    async function doList() {

        // call the web service and await for the reply to come back and be converted to JSON
        const reply = await fetch(URL + "list");
        const json = await reply.json();

        // identify the spinner, if available, using the id 'loader'...
        let spinner = document.getElementById("loader");
        // .. and stop it (by hiding it)
        spinner.hidden = true;

        // access the "treasureHunts" array on the reply message
        let treasureHuntsArray = json.treasureHunts;
        let listHtml = "list.html"; // dynamically form the HTML code to display the list of treasure hunts
        for(let i = 0; i < treasureHuntsArray.length; i++) {
            listHtml += // each treasure hunt item is shown with an individual DIV element
                "<li>" +
                "<b>" + treasureHuntsArray[i].name + "</b><br/>" + // the treasure hunt name is shown in bold...
                "<i>" + treasureHuntsArray[i].description + "</i><br/>" + // and the description in italics in the following line
                "<a href=\"javascript:select(\'" + treasureHuntsArray[i].uuid + "\')\">Start</a>" + // and the description in italics in the following line
                "</li>";
        }
        listHtml += "</ul>";
        // update the DOM with the newly created list
        document.getElementById("treasureHunts").innerHTML = listHtml;
    }

    async function select(uuid) {
        // For now just print the selected treasure hunt's UUID. Normally, you're expected to guide the user in entering
        // their name etc. and proceed to calling the '/start' command of the API to start a new session.
        console.log("Selected treasure hunt with UUID: " + uuid);
        //
    }
</script>
<footer>
    <div class="column" style="background-color:saddlebrown;">
        <h2>Follow us on:</h2>
        <a href="https://www.instagram.com/treasurehuntco1111/">
            <img src="../images/Instagram_logo_2016.jpg" height="40" width="40"/>
        </a>
        <a href="https://twitter.com/huntco1111">
            <img src="../images/u6qfBBkF_400x400.jpg" height="40" width="40"/>
        </a>
        <a href="https://www.tiktok.com/@treasurehuntco1111">
            <img src="../images/761b5a3f301cbc3cb3a98f9d63169076.png" height="40" width="40"/>
        </a>
    </div>
    <div class="column" style="background-color:saddlebrown;">


    </div>

    <div class="column" style="background-color:saddlebrown;">
        <h2>Collaborators:</h2>
        <p> Michalis Sampson, Nikolas Papamichael</p>
        <p> Arsenios Hadjigeorgiou, Constantinos Koliaros</p>

    </div>
</footer>
</body>
</html>